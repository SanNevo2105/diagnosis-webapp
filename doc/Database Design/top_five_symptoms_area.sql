-- ACCEPT start_date DATE

use team059;
drop procedure top_five_symptoms_area; 


-- for loop all symptoms
delimiter //
create procedure top_five_symptoms_area(in user_input_location POINT, in input_date DATE, in duration INT, in distance FLOAT, in p_explain tinyint unsigned)
begin
	if (p_explain) then
		explain analyze
        	with symptom_list as (
				SELECT *
				FROM User_Queries
				WHERE SQRT(POW(ST_X(user_input_location) - ST_X(location),2 ) + POW(ST_Y(user_input_location) - ST_Y(location),2)) <= distance -- distance
				AND ABS(input_date - date) <= duration -- date restriction
			) 
			
			SELECT symptom , count(symptom) AS occurrence
				from (
					select 'itching' as symptom from symptom_list where symptom_list.itching = 1 union all select 'skin_rash' as symptom from symptom_list where symptom_list.skin_rash = 1 union all select 'nodal_skin_eruptions' as symptom from symptom_list where symptom_list.nodal_skin_eruptions = 1 union all select 'continuous_sneezing' as symptom from symptom_list where symptom_list.continuous_sneezing = 1 union all select 'shivering' as symptom from symptom_list where symptom_list.shivering = 1 union all select 'chills' as symptom from symptom_list where symptom_list.chills = 1 union all select 'joint_pain' as symptom from symptom_list where symptom_list.joint_pain = 1 union all select 'stomach_pain' as symptom from symptom_list where symptom_list.stomach_pain = 1 union all select 'acidity' as symptom from symptom_list where symptom_list.acidity = 1 union all select 'ulcers_on_tongue' as symptom from symptom_list where symptom_list.ulcers_on_tongue = 1 union all select 'muscle_wasting' as symptom from symptom_list where symptom_list.muscle_wasting = 1 union all select 'vomiting' as symptom from symptom_list where symptom_list.vomiting = 1 union all select 'burning_micturition' as symptom from symptom_list where symptom_list.burning_micturition = 1 union all select 'spotting_urination' as symptom from symptom_list where symptom_list.spotting_urination = 1 union all select 'fatigue' as symptom from symptom_list where symptom_list.fatigue = 1 union all select 'weight_gain' as symptom from symptom_list where symptom_list.weight_gain = 1 union all select 'anxiety' as symptom from symptom_list where symptom_list.anxiety = 1 union all select 'cold_hands_and_feets' as symptom from symptom_list where symptom_list.cold_hands_and_feets = 1 union all select 'mood_swings' as symptom from symptom_list where symptom_list.mood_swings = 1 union all select 'weight_loss' as symptom from symptom_list where symptom_list.weight_loss = 1 union all select 'restlessness' as symptom from symptom_list where symptom_list.restlessness = 1 union all select 'lethargy' as symptom from symptom_list where symptom_list.lethargy = 1 union all select 'patches_in_throat' as symptom from symptom_list where symptom_list.patches_in_throat = 1 union all select 'irregular_sugar_level' as symptom from symptom_list where symptom_list.irregular_sugar_level = 1 union all select 'cough' as symptom from symptom_list where symptom_list.cough = 1 union all select 'high_fever' as symptom from symptom_list where symptom_list.high_fever = 1 union all select 'sunken_eyes' as symptom from symptom_list where symptom_list.sunken_eyes = 1 union all select 'breathlessness' as symptom from symptom_list where symptom_list.breathlessness = 1 union all select 'sweating' as symptom from symptom_list where symptom_list.sweating = 1 union all select 'dehydration' as symptom from symptom_list where symptom_list.dehydration = 1 union all select 'indigestion' as symptom from symptom_list where symptom_list.indigestion = 1 union all select 'headache' as symptom from symptom_list where symptom_list.headache = 1 union all select 'yellowish_skin' as symptom from symptom_list where symptom_list.yellowish_skin = 1 union all select 'dark_urine' as symptom from symptom_list where symptom_list.dark_urine = 1 union all select 'nausea' as symptom from symptom_list where symptom_list.nausea = 1 union all select 'loss_of_appetite' as symptom from symptom_list where symptom_list.loss_of_appetite = 1 union all select 'pain_behind_the_eyes' as symptom from symptom_list where symptom_list.pain_behind_the_eyes = 1 union all select 'back_pain' as symptom from symptom_list where symptom_list.back_pain = 1 union all select 'constipation' as symptom from symptom_list where symptom_list.constipation = 1 union all select 'abdominal_pain' as symptom from symptom_list where symptom_list.abdominal_pain = 1 union all select 'diarrhoea' as symptom from symptom_list where symptom_list.diarrhoea = 1 union all select 'mild_fever' as symptom from symptom_list where symptom_list.mild_fever = 1 union all select 'yellow_urine' as symptom from symptom_list where symptom_list.yellow_urine = 1 union all select 'yellowing_of_eyes' as symptom from symptom_list where symptom_list.yellowing_of_eyes = 1 union all select 'acute_liver_failure' as symptom from symptom_list where symptom_list.acute_liver_failure = 1 union all select 'fluid_overload' as symptom from symptom_list where symptom_list.fluid_overload = 1 union all select 'swelling_of_stomach' as symptom from symptom_list where symptom_list.swelling_of_stomach = 1 union all select 'swelled_lymph_nodes' as symptom from symptom_list where symptom_list.swelled_lymph_nodes = 1 union all select 'malaise' as symptom from symptom_list where symptom_list.malaise = 1 union all select 'blurred_and_distorted_vision' as symptom from symptom_list where symptom_list.blurred_and_distorted_vision = 1 union all select 'phlegm' as symptom from symptom_list where symptom_list.phlegm = 1 union all select 'throat_irritation' as symptom from symptom_list where symptom_list.throat_irritation = 1 union all select 'redness_of_eyes' as symptom from symptom_list where symptom_list.redness_of_eyes = 1 union all select 'sinus_pressure' as symptom from symptom_list where symptom_list.sinus_pressure = 1 union all select 'runny_nose' as symptom from symptom_list where symptom_list.runny_nose = 1 union all select 'congestion' as symptom from symptom_list where symptom_list.congestion = 1 union all select 'chest_pain' as symptom from symptom_list where symptom_list.chest_pain = 1 union all select 'weakness_in_limbs' as symptom from symptom_list where symptom_list.weakness_in_limbs = 1 union all select 'fast_heart_rate' as symptom from symptom_list where symptom_list.fast_heart_rate = 1 union all select 'pain_during_bowel_movements' as symptom from symptom_list where symptom_list.pain_during_bowel_movements = 1 union all select 'pain_in_anal_region' as symptom from symptom_list where symptom_list.pain_in_anal_region = 1 union all select 'bloody_stool' as symptom from symptom_list where symptom_list.bloody_stool = 1 union all select 'irritation_in_anus' as symptom from symptom_list where symptom_list.irritation_in_anus = 1 union all select 'neck_pain' as symptom from symptom_list where symptom_list.neck_pain = 1 union all select 'dizziness' as symptom from symptom_list where symptom_list.dizziness = 1 union all select 'cramps' as symptom from symptom_list where symptom_list.cramps = 1 union all select 'bruising' as symptom from symptom_list where symptom_list.bruising = 1 union all select 'obesity' as symptom from symptom_list where symptom_list.obesity = 1 union all select 'swollen_legs' as symptom from symptom_list where symptom_list.swollen_legs = 1 union all select 'swollen_blood_vessels' as symptom from symptom_list where symptom_list.swollen_blood_vessels = 1 union all select 'puffy_face_and_eyes' as symptom from symptom_list where symptom_list.puffy_face_and_eyes = 1 union all select 'enlarged_thyroid' as symptom from symptom_list where symptom_list.enlarged_thyroid = 1 union all select 'brittle_nails' as symptom from symptom_list where symptom_list.brittle_nails = 1 union all select 'swollen_extremeties' as symptom from symptom_list where symptom_list.swollen_extremeties = 1 union all select 'excessive_hunger' as symptom from symptom_list where symptom_list.excessive_hunger = 1 union all select 'extra_marital_contacts' as symptom from symptom_list where symptom_list.extra_marital_contacts = 1 union all select 'drying_and_tingling_lips' as symptom from symptom_list where symptom_list.drying_and_tingling_lips = 1 union all select 'slurred_speech' as symptom from symptom_list where symptom_list.slurred_speech = 1 union all select 'knee_pain' as symptom from symptom_list where symptom_list.knee_pain = 1 union all select 'hip_joint_pain' as symptom from symptom_list where symptom_list.hip_joint_pain = 1 union all select 'muscle_weakness' as symptom from symptom_list where symptom_list.muscle_weakness = 1 union all select 'stiff_neck' as symptom from symptom_list where symptom_list.stiff_neck = 1 union all select 'swelling_joints' as symptom from symptom_list where symptom_list.swelling_joints = 1 union all select 'movement_stiffness' as symptom from symptom_list where symptom_list.movement_stiffness = 1 union all select 'spinning_movements' as symptom from symptom_list where symptom_list.spinning_movements = 1 union all select 'loss_of_balance' as symptom from symptom_list where symptom_list.loss_of_balance = 1 union all select 'unsteadiness' as symptom from symptom_list where symptom_list.unsteadiness = 1 union all select 'weakness_of_one_body_side' as symptom from symptom_list where symptom_list.weakness_of_one_body_side = 1 union all select 'loss_of_smell' as symptom from symptom_list where symptom_list.loss_of_smell = 1 union all select 'bladder_discomfort' as symptom from symptom_list where symptom_list.bladder_discomfort = 1 union all select 'foul_smell_of_urine' as symptom from symptom_list where symptom_list.foul_smell_of_urine = 1 union all select 'continuous_feel_of_urine' as symptom from symptom_list where symptom_list.continuous_feel_of_urine = 1 union all select 'passage_of_gases' as symptom from symptom_list where symptom_list.passage_of_gases = 1 union all select 'internal_itching' as symptom from symptom_list where symptom_list.internal_itching = 1 union all select 'toxic_look_typhos' as symptom from symptom_list where symptom_list.toxic_look_typhos = 1 union all select 'depression' as symptom from symptom_list where symptom_list.depression = 1 union all select 'irritability' as symptom from symptom_list where symptom_list.irritability = 1 union all select 'muscle_pain' as symptom from symptom_list where symptom_list.muscle_pain = 1 union all select 'altered_sensorium' as symptom from symptom_list where symptom_list.altered_sensorium = 1 union all select 'red_spots_over_body' as symptom from symptom_list where symptom_list.red_spots_over_body = 1 union all select 'belly_pain' as symptom from symptom_list where symptom_list.belly_pain = 1 union all select 'abnormal_menstruation' as symptom from symptom_list where symptom_list.abnormal_menstruation = 1 union all select 'dischromic_patches' as symptom from symptom_list where symptom_list.dischromic_patches = 1 union all select 'watering_from_eyes' as symptom from symptom_list where symptom_list.watering_from_eyes = 1 union all select 'increased_appetite' as symptom from symptom_list where symptom_list.increased_appetite = 1 union all select 'polyuria' as symptom from symptom_list where symptom_list.polyuria = 1 union all select 'family_history' as symptom from symptom_list where symptom_list.family_history = 1 union all select 'mucoid_sputum' as symptom from symptom_list where symptom_list.mucoid_sputum = 1 union all select 'rusty_sputum' as symptom from symptom_list where symptom_list.rusty_sputum = 1 union all select 'lack_of_concentration' as symptom from symptom_list where symptom_list.lack_of_concentration = 1 union all select 'visual_disturbances' as symptom from symptom_list where symptom_list.visual_disturbances = 1 union all select 'receiving_blood_transfusion' as symptom from symptom_list where symptom_list.receiving_blood_transfusion = 1 union all select 'receiving_unsterile_injections' as symptom from symptom_list where symptom_list.receiving_unsterile_injections = 1 union all select 'coma' as symptom from symptom_list where symptom_list.coma = 1 union all select 'stomach_bleeding' as symptom from symptom_list where symptom_list.stomach_bleeding = 1 union all select 'distention_of_abdomen' as symptom from symptom_list where symptom_list.distention_of_abdomen = 1 union all select 'history_of_alcohol_consumption' as symptom from symptom_list where symptom_list.history_of_alcohol_consumption = 1 union all select 'blood_in_sputum' as symptom from symptom_list where symptom_list.blood_in_sputum = 1 union all select 'prominent_veins_on_calf' as symptom from symptom_list where symptom_list.prominent_veins_on_calf = 1 union all select 'palpitations' as symptom from symptom_list where symptom_list.palpitations = 1 union all select 'painful_walking' as symptom from symptom_list where symptom_list.painful_walking = 1 union all select 'pus_filled_pimples' as symptom from symptom_list where symptom_list.pus_filled_pimples = 1 union all select 'blackheads' as symptom from symptom_list where symptom_list.blackheads = 1 union all select 'scurring' as symptom from symptom_list where symptom_list.scurring = 1 union all select 'skin_peeling' as symptom from symptom_list where symptom_list.skin_peeling = 1 union all select 'silver_like_dusting' as symptom from symptom_list where symptom_list.silver_like_dusting = 1 union all select 'small_dents_in_nails' as symptom from symptom_list where symptom_list.small_dents_in_nails = 1 union all select 'inflammatory_nails' as symptom from symptom_list where symptom_list.inflammatory_nails = 1 union all select 'blister' as symptom from symptom_list where symptom_list.blister = 1 union all select 'ed_sore_around_nose' as symptom from symptom_list where symptom_list.ed_sore_around_nose = 1 union all select 'yellow_crust_ooze' as symptom from symptom_list where symptom_list.yellow_crust_ooze = 1 
                    ) as temp
					group by symptom
					ORDER BY occurrence DESC, symptom
					LIMIT 5;
	else
			with symptom_list as (
				SELECT *
				FROM User_Queries
				WHERE SQRT(POW(ST_X(user_input_location) - ST_X(location),2 ) + POW(ST_Y(user_input_location) - ST_Y(location),2)) <= distance -- distance
				AND ABS(input_date - date) <= duration -- date restriction
			) 
			
			SELECT symptom , count(symptom) AS occurrence
				from (
					select 'itching' as symptom from symptom_list where symptom_list.itching = 1 union all select 'skin_rash' as symptom from symptom_list where symptom_list.skin_rash = 1 union all select 'nodal_skin_eruptions' as symptom from symptom_list where symptom_list.nodal_skin_eruptions = 1 union all select 'continuous_sneezing' as symptom from symptom_list where symptom_list.continuous_sneezing = 1 union all select 'shivering' as symptom from symptom_list where symptom_list.shivering = 1 union all select 'chills' as symptom from symptom_list where symptom_list.chills = 1 union all select 'joint_pain' as symptom from symptom_list where symptom_list.joint_pain = 1 union all select 'stomach_pain' as symptom from symptom_list where symptom_list.stomach_pain = 1 union all select 'acidity' as symptom from symptom_list where symptom_list.acidity = 1 union all select 'ulcers_on_tongue' as symptom from symptom_list where symptom_list.ulcers_on_tongue = 1 union all select 'muscle_wasting' as symptom from symptom_list where symptom_list.muscle_wasting = 1 union all select 'vomiting' as symptom from symptom_list where symptom_list.vomiting = 1 union all select 'burning_micturition' as symptom from symptom_list where symptom_list.burning_micturition = 1 union all select 'spotting_urination' as symptom from symptom_list where symptom_list.spotting_urination = 1 union all select 'fatigue' as symptom from symptom_list where symptom_list.fatigue = 1 union all select 'weight_gain' as symptom from symptom_list where symptom_list.weight_gain = 1 union all select 'anxiety' as symptom from symptom_list where symptom_list.anxiety = 1 union all select 'cold_hands_and_feets' as symptom from symptom_list where symptom_list.cold_hands_and_feets = 1 union all select 'mood_swings' as symptom from symptom_list where symptom_list.mood_swings = 1 union all select 'weight_loss' as symptom from symptom_list where symptom_list.weight_loss = 1 union all select 'restlessness' as symptom from symptom_list where symptom_list.restlessness = 1 union all select 'lethargy' as symptom from symptom_list where symptom_list.lethargy = 1 union all select 'patches_in_throat' as symptom from symptom_list where symptom_list.patches_in_throat = 1 union all select 'irregular_sugar_level' as symptom from symptom_list where symptom_list.irregular_sugar_level = 1 union all select 'cough' as symptom from symptom_list where symptom_list.cough = 1 union all select 'high_fever' as symptom from symptom_list where symptom_list.high_fever = 1 union all select 'sunken_eyes' as symptom from symptom_list where symptom_list.sunken_eyes = 1 union all select 'breathlessness' as symptom from symptom_list where symptom_list.breathlessness = 1 union all select 'sweating' as symptom from symptom_list where symptom_list.sweating = 1 union all select 'dehydration' as symptom from symptom_list where symptom_list.dehydration = 1 union all select 'indigestion' as symptom from symptom_list where symptom_list.indigestion = 1 union all select 'headache' as symptom from symptom_list where symptom_list.headache = 1 union all select 'yellowish_skin' as symptom from symptom_list where symptom_list.yellowish_skin = 1 union all select 'dark_urine' as symptom from symptom_list where symptom_list.dark_urine = 1 union all select 'nausea' as symptom from symptom_list where symptom_list.nausea = 1 union all select 'loss_of_appetite' as symptom from symptom_list where symptom_list.loss_of_appetite = 1 union all select 'pain_behind_the_eyes' as symptom from symptom_list where symptom_list.pain_behind_the_eyes = 1 union all select 'back_pain' as symptom from symptom_list where symptom_list.back_pain = 1 union all select 'constipation' as symptom from symptom_list where symptom_list.constipation = 1 union all select 'abdominal_pain' as symptom from symptom_list where symptom_list.abdominal_pain = 1 union all select 'diarrhoea' as symptom from symptom_list where symptom_list.diarrhoea = 1 union all select 'mild_fever' as symptom from symptom_list where symptom_list.mild_fever = 1 union all select 'yellow_urine' as symptom from symptom_list where symptom_list.yellow_urine = 1 union all select 'yellowing_of_eyes' as symptom from symptom_list where symptom_list.yellowing_of_eyes = 1 union all select 'acute_liver_failure' as symptom from symptom_list where symptom_list.acute_liver_failure = 1 union all select 'fluid_overload' as symptom from symptom_list where symptom_list.fluid_overload = 1 union all select 'swelling_of_stomach' as symptom from symptom_list where symptom_list.swelling_of_stomach = 1 union all select 'swelled_lymph_nodes' as symptom from symptom_list where symptom_list.swelled_lymph_nodes = 1 union all select 'malaise' as symptom from symptom_list where symptom_list.malaise = 1 union all select 'blurred_and_distorted_vision' as symptom from symptom_list where symptom_list.blurred_and_distorted_vision = 1 union all select 'phlegm' as symptom from symptom_list where symptom_list.phlegm = 1 union all select 'throat_irritation' as symptom from symptom_list where symptom_list.throat_irritation = 1 union all select 'redness_of_eyes' as symptom from symptom_list where symptom_list.redness_of_eyes = 1 union all select 'sinus_pressure' as symptom from symptom_list where symptom_list.sinus_pressure = 1 union all select 'runny_nose' as symptom from symptom_list where symptom_list.runny_nose = 1 union all select 'congestion' as symptom from symptom_list where symptom_list.congestion = 1 union all select 'chest_pain' as symptom from symptom_list where symptom_list.chest_pain = 1 union all select 'weakness_in_limbs' as symptom from symptom_list where symptom_list.weakness_in_limbs = 1 union all select 'fast_heart_rate' as symptom from symptom_list where symptom_list.fast_heart_rate = 1 union all select 'pain_during_bowel_movements' as symptom from symptom_list where symptom_list.pain_during_bowel_movements = 1 union all select 'pain_in_anal_region' as symptom from symptom_list where symptom_list.pain_in_anal_region = 1 union all select 'bloody_stool' as symptom from symptom_list where symptom_list.bloody_stool = 1 union all select 'irritation_in_anus' as symptom from symptom_list where symptom_list.irritation_in_anus = 1 union all select 'neck_pain' as symptom from symptom_list where symptom_list.neck_pain = 1 union all select 'dizziness' as symptom from symptom_list where symptom_list.dizziness = 1 union all select 'cramps' as symptom from symptom_list where symptom_list.cramps = 1 union all select 'bruising' as symptom from symptom_list where symptom_list.bruising = 1 union all select 'obesity' as symptom from symptom_list where symptom_list.obesity = 1 union all select 'swollen_legs' as symptom from symptom_list where symptom_list.swollen_legs = 1 union all select 'swollen_blood_vessels' as symptom from symptom_list where symptom_list.swollen_blood_vessels = 1 union all select 'puffy_face_and_eyes' as symptom from symptom_list where symptom_list.puffy_face_and_eyes = 1 union all select 'enlarged_thyroid' as symptom from symptom_list where symptom_list.enlarged_thyroid = 1 union all select 'brittle_nails' as symptom from symptom_list where symptom_list.brittle_nails = 1 union all select 'swollen_extremeties' as symptom from symptom_list where symptom_list.swollen_extremeties = 1 union all select 'excessive_hunger' as symptom from symptom_list where symptom_list.excessive_hunger = 1 union all select 'extra_marital_contacts' as symptom from symptom_list where symptom_list.extra_marital_contacts = 1 union all select 'drying_and_tingling_lips' as symptom from symptom_list where symptom_list.drying_and_tingling_lips = 1 union all select 'slurred_speech' as symptom from symptom_list where symptom_list.slurred_speech = 1 union all select 'knee_pain' as symptom from symptom_list where symptom_list.knee_pain = 1 union all select 'hip_joint_pain' as symptom from symptom_list where symptom_list.hip_joint_pain = 1 union all select 'muscle_weakness' as symptom from symptom_list where symptom_list.muscle_weakness = 1 union all select 'stiff_neck' as symptom from symptom_list where symptom_list.stiff_neck = 1 union all select 'swelling_joints' as symptom from symptom_list where symptom_list.swelling_joints = 1 union all select 'movement_stiffness' as symptom from symptom_list where symptom_list.movement_stiffness = 1 union all select 'spinning_movements' as symptom from symptom_list where symptom_list.spinning_movements = 1 union all select 'loss_of_balance' as symptom from symptom_list where symptom_list.loss_of_balance = 1 union all select 'unsteadiness' as symptom from symptom_list where symptom_list.unsteadiness = 1 union all select 'weakness_of_one_body_side' as symptom from symptom_list where symptom_list.weakness_of_one_body_side = 1 union all select 'loss_of_smell' as symptom from symptom_list where symptom_list.loss_of_smell = 1 union all select 'bladder_discomfort' as symptom from symptom_list where symptom_list.bladder_discomfort = 1 union all select 'foul_smell_of_urine' as symptom from symptom_list where symptom_list.foul_smell_of_urine = 1 union all select 'continuous_feel_of_urine' as symptom from symptom_list where symptom_list.continuous_feel_of_urine = 1 union all select 'passage_of_gases' as symptom from symptom_list where symptom_list.passage_of_gases = 1 union all select 'internal_itching' as symptom from symptom_list where symptom_list.internal_itching = 1 union all select 'toxic_look_typhos' as symptom from symptom_list where symptom_list.toxic_look_typhos = 1 union all select 'depression' as symptom from symptom_list where symptom_list.depression = 1 union all select 'irritability' as symptom from symptom_list where symptom_list.irritability = 1 union all select 'muscle_pain' as symptom from symptom_list where symptom_list.muscle_pain = 1 union all select 'altered_sensorium' as symptom from symptom_list where symptom_list.altered_sensorium = 1 union all select 'red_spots_over_body' as symptom from symptom_list where symptom_list.red_spots_over_body = 1 union all select 'belly_pain' as symptom from symptom_list where symptom_list.belly_pain = 1 union all select 'abnormal_menstruation' as symptom from symptom_list where symptom_list.abnormal_menstruation = 1 union all select 'dischromic_patches' as symptom from symptom_list where symptom_list.dischromic_patches = 1 union all select 'watering_from_eyes' as symptom from symptom_list where symptom_list.watering_from_eyes = 1 union all select 'increased_appetite' as symptom from symptom_list where symptom_list.increased_appetite = 1 union all select 'polyuria' as symptom from symptom_list where symptom_list.polyuria = 1 union all select 'family_history' as symptom from symptom_list where symptom_list.family_history = 1 union all select 'mucoid_sputum' as symptom from symptom_list where symptom_list.mucoid_sputum = 1 union all select 'rusty_sputum' as symptom from symptom_list where symptom_list.rusty_sputum = 1 union all select 'lack_of_concentration' as symptom from symptom_list where symptom_list.lack_of_concentration = 1 union all select 'visual_disturbances' as symptom from symptom_list where symptom_list.visual_disturbances = 1 union all select 'receiving_blood_transfusion' as symptom from symptom_list where symptom_list.receiving_blood_transfusion = 1 union all select 'receiving_unsterile_injections' as symptom from symptom_list where symptom_list.receiving_unsterile_injections = 1 union all select 'coma' as symptom from symptom_list where symptom_list.coma = 1 union all select 'stomach_bleeding' as symptom from symptom_list where symptom_list.stomach_bleeding = 1 union all select 'distention_of_abdomen' as symptom from symptom_list where symptom_list.distention_of_abdomen = 1 union all select 'history_of_alcohol_consumption' as symptom from symptom_list where symptom_list.history_of_alcohol_consumption = 1 union all select 'blood_in_sputum' as symptom from symptom_list where symptom_list.blood_in_sputum = 1 union all select 'prominent_veins_on_calf' as symptom from symptom_list where symptom_list.prominent_veins_on_calf = 1 union all select 'palpitations' as symptom from symptom_list where symptom_list.palpitations = 1 union all select 'painful_walking' as symptom from symptom_list where symptom_list.painful_walking = 1 union all select 'pus_filled_pimples' as symptom from symptom_list where symptom_list.pus_filled_pimples = 1 union all select 'blackheads' as symptom from symptom_list where symptom_list.blackheads = 1 union all select 'scurring' as symptom from symptom_list where symptom_list.scurring = 1 union all select 'skin_peeling' as symptom from symptom_list where symptom_list.skin_peeling = 1 union all select 'silver_like_dusting' as symptom from symptom_list where symptom_list.silver_like_dusting = 1 union all select 'small_dents_in_nails' as symptom from symptom_list where symptom_list.small_dents_in_nails = 1 union all select 'inflammatory_nails' as symptom from symptom_list where symptom_list.inflammatory_nails = 1 union all select 'blister' as symptom from symptom_list where symptom_list.blister = 1 union all select 'ed_sore_around_nose' as symptom from symptom_list where symptom_list.ed_sore_around_nose = 1 union all select 'yellow_crust_ooze' as symptom from symptom_list where symptom_list.yellow_crust_ooze = 1 
                    ) as temp
                    group by symptom
					ORDER BY occurrence DESC, symptom
					LIMIT 5;
                    
	end if;
	end //
delimiter ;



